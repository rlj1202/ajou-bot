<!doctype html>
<html>
  <head>
    <title>ì•„ì£¼ëŒ€í•™êµ ê³µì§€ì‚¬í•­ ë´‡</title>

    <style></style>
  </head>
  <body>
    <script>
      async function handleSubscribe() {
        const webhookUrlInput = document.querySelector("#webhook-url");
        if (!(webhookUrlInput instanceof HTMLInputElement)) return;

        const url = webhookUrlInput.value;

        const subscribeUrl =
          "https://8e4dfsnfwb.execute-api.ap-northeast-2.amazonaws.com/subscribe";

        try {
          const resp = await fetch(subscribeUrl, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ url: url }),
          });

          console.log(resp);

          if (resp.status === 201) {
            alert("êµ¬ë…ë˜ì—ˆìŠµë‹ˆë‹¤");
          } else {
            alert("ë¬´ì–¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤");
          }
        } catch (err) {
          console.error(err);
        }
      }
      async function handleUnsubscribe() {
        const webhookUrlInput = document.querySelector("#webhook-url");
        if (!(webhookUrlInput instanceof HTMLInputElement)) return;

        const url = webhookUrlInput.value;

        const unsubscribeUrl =
          "https://8e4dfsnfwb.execute-api.ap-northeast-2.amazonaws.com/unsubscribe";

        try {
          const resp = await fetch(unsubscribeUrl, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ url: url }),
          });

          console.log(resp);

          if (resp.status === 200) {
            alert("êµ¬ë… ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤");
          } else {
            alert("ë¬´ì–¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤");
          }
        } catch (err) {
          console.error(err);
        }
      }
    </script>

    <h1>ğŸ¤– ì•„ì£¼ëŒ€í•™êµ ê³µì§€ì‚¬í•­ ë´‡</h1>

    <p>
      ì•„ë˜ì— ë””ìŠ¤ì½”ë“œ ì›¹í›… urlì„ ë„£ê³  êµ¬ë… í˜¹ì€ êµ¬ë… ì·¨ì†Œ ë²„íŠ¼ì„ ëˆ„ë¥´ì‹œë©´
      ë©ë‹ˆë‹¹.
    </p>

    <form>
      <input
        id="webhook-url"
        placeholder="https://discord.com/api/webhooks/{webhook-id}/{webhook-token}"
      />

      <button type="button" onclick="handleSubscribe()">êµ¬ë…</button>
      <button type="button" onclick="handleUnsubscribe()">êµ¬ë… ì·¨ì†Œ</button>
    </form>

    <p>ë¬¸ì˜: <a href="mailto:rlj1202@gmail.com">rlj1202@gmail.com</a></p>
  </body>
</html>
